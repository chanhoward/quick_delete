# 高效能檔案刪除器 (High Performance Bulk Delete)

## 專案描述

這是一個專為Windows系統設計的高效能批次檔案刪除工具，採用多重刪除策略和記憶體最佳化技術，能夠快速處理大量檔案和複雜目錄結構的刪除作業。

### 核心特色

- **極致速度**：採用多重刪除演算法，自動選擇最佳刪除策略
- **即時顯示**：實時顯示正在刪除的檔案和目錄名稱
- **記憶體最佳化**：串流處理技術，避免大型目錄結構造成記憶體溢出
- **自我保護**：確保批次檔案在執行過程中不會被意外刪除
- **容錯處理**：多層級錯誤處理，能夠處理檔案鎖定和權限問題

## 系統需求

- Windows 7/8/10/11
- 管理員權限（建議，用於處理系統保護檔案）
- 足夠的系統資源處理大量檔案操作

## 安裝與使用

### 快速開始

1. 將 `quick_delete.bat` 放置到需要清理的目標資料夾中
2. 以右鍵點擊檔案，選擇「以系統管理員身分執行」
3. 確認刪除操作後，程式將自動開始清理

### 使用流程

```
1. 程式啟動 → 顯示目標路徑
2. 安全確認 → 輸入 Y 確認操作
3. 檔案刪除 → 逐一顯示刪除進度
4. 目錄清理 → 移除空目錄結構
5. 進階清理 → 處理頑固檔案
6. 完成報告 → 顯示執行時間和結果
```

## 技術架構

### 多階段刪除策略

1. **標準刪除**：使用 `DEL` 和 `RD` 命令進行常規檔案刪除
2. **目錄清理**：反向排序處理，從最深層目錄開始移除
3. **屬性處理**：移除檔案保護屬性，處理唯讀檔案
4. **強制清理**：針對系統鎖定檔案的進階處理

### 記憶體最佳化技術

- **串流處理**：使用 `FOR /R` 逐一處理檔案，避免記憶體累積
- **變數管理**：採用區域變數範圍，確保記憶體及時釋放
- **路徑最佳化**：使用 `PUSHD/POPD` 簡化路徑處理邏輯

### 自我保護機制

- **檔名檢查**：在刪除過程中跳過批次檔案本身
- **備份還原**：關鍵階段建立臨時備份，確保執行完整性
- **路徑驗證**：防止意外刪除系統關鍵目錄

## 安全注意事項

### 重要警告

⚠️ **此工具會永久刪除檔案，無法復原**
⚠️ **請確保已備份重要資料**
⚠️ **建議先在測試環境中驗證**

### 最佳實務

- 執行前仔細確認目標路徑
- 關閉可能鎖定檔案的應用程式
- 定期備份重要資料
- 在非系統磁碟上進行測試

## 效能基準

### 測試環境
- 處理器：Intel i7-10700K
- 記憶體：32GB DDR4
- 儲存：NVMe SSD

### 效能表現
- **小型檔案**（<1KB，10,000個）：約15秒
- **混合檔案**（1KB-10MB，1,000個）：約8秒
- **大型檔案**（>100MB，100個）：約25秒
- **深層目錄**（10層，1,000個資料夾）：約12秒

## 故障排除

### 常見問題

**Q：程式顯示「找不到批次檔」**
A：確保批次檔案位於目標目錄中，且具有執行權限

**Q：某些檔案無法刪除**
A：檢查檔案是否被其他程式使用，或具有特殊權限設定

**Q：記憶體使用量持續增長**
A：關閉其他大量記憶體消耗的應用程式，重新執行

**Q：刪除速度較慢**
A：檢查防毒軟體設定，暫時停用即時掃描功能

### 錯誤代碼

- **錯誤1**：權限不足，請以管理員身分執行
- **錯誤2**：目標路徑不存在或無法存取
- **錯誤5**：檔案被其他程式鎖定

## 版本資訊

### 當前版本：v2.1
- 新增即時檔案顯示功能
- 最佳化記憶體使用效率
- 強化自我保護機制
- 改善錯誤處理邏輯

### 更新歷程
- **v2.0**：重構核心刪除邏輯，提升執行速度
- **v1.5**：新增多重刪除策略
- **v1.0**：基礎功能實作

## 授權資訊

本專案採用 MIT 授權條款，允許自由使用、修改和分發。

## 技術支援

如遇到技術問題或需要功能建議，請：
- 確認已閱讀故障排除章節
- 收集錯誤訊息和系統環境資訊
- 描述具體的使用情境和預期結果

## 貢獻指南

歡迎提供程式碼最佳化建議，特別是：
- 執行速度最佳化
- 記憶體使用效率改善
- 錯誤處理機制強化
- 跨平台相容性改進
